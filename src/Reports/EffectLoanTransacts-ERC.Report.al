// //dotnet // --> Reports ForNAV Autogenerated code - do not delete or modify
// //{
// //assembly("ForNav.Reports.7.3.0.2559")
// // {
// //   type(ForNav.Report_7_3_0_2559; ForNavReport51511084_v7_3_0_2559) { }
// //}
// //assembly("mscorlib")
// //  {
// //    Version = '4.0.0.0';
// //    type("System.IO.Stream"; SystemIOStream51511084) { }
// //type("System.IO.Path"; System_IO_Path51511084) { }
// //   }
// //} // Reports ForNAV Autogenerated code - do not delete or modify -->

// Report 52193508 "Effect Loan Transacts -ERC"
// {
//     RDLCLayout = './Layouts/EffectLoanTransacts-ERC.rdlc';
//     DefaultLayout = RDLC;

//     dataset
//     {
//         dataitem("Loan Application1"; "Loan Application1")
//         {
//             DataItemTableView = sorting("Loan No", "Loan Product Type");
//             RequestFilterFields = "Loan Status";
//             column(ReportForNavId_3301; 3301) { } // Autogenerated by ForNav - Do not delete
//             column(FORMAT_TODAY_0_4_; Format(Today, 0, 4))
//             {
//             }
//             column(COMPANYNAME; COMPANYNAME)
//             {
//             }
//             //column(CurrReport_PAGENO; Format(//ReportForNav.PageNo))
//             // {
//             // }
//             column(USERID; UserId)
//             {
//             }
//             column(Loan_Application1__Loan_No_; "Loan Application1"."Loan No")
//             {
//             }
//             column(Loan_Application1__Application_Date_; "Loan Application1"."Application Date")
//             {
//             }
//             column(Loan_Application1__Loan_Product_Type_; "Loan Application1"."Loan Product Type")
//             {
//             }
//             column(Loan_Application1__Amount_Requested_; "Loan Application1"."Amount Requested")
//             {
//             }
//             column(Loan_Application1__Approved_Amount_; "Loan Application1"."Approved Amount")
//             {
//             }
//             column(Loan_Application1__Loan_Status_; "Loan Application1"."Loan Status")
//             {
//             }
//             column(Loan_Application1__Issued_Date_; "Loan Application1"."Issued Date")
//             {
//             }
//             column(Loan_Application1__Deduction_Code_; "Loan Application1"."Deduction Code")
//             {
//             }
//             column(Loan_Application1__Interest_Deduction_Code_; "Loan Application1"."Interest Deduction Code")
//             {
//             }
//             column(Loan_Application1__Interest_Rate_; "Loan Application1"."Interest Rate")
//             {
//             }
//             column(Loan_ApplicationCaption; Loan_ApplicationCaptionLbl)
//             {
//             }
//             column(CurrReport_PAGENOCaption; CurrReport_PAGENOCaptionLbl)
//             {
//             }
//             column(Loan_Application1__Loan_No_Caption; FieldCaption("Loan No"))
//             {
//             }
//             column(Loan_Application1__Application_Date_Caption; FieldCaption("Application Date"))
//             {
//             }
//             column(Loan_Application1__Loan_Product_Type_Caption; FieldCaption("Loan Product Type"))
//             {
//             }
//             column(Loan_Application1__Amount_Requested_Caption; FieldCaption("Amount Requested"))
//             {
//             }
//             column(Loan_Application1__Approved_Amount_Caption; FieldCaption("Approved Amount"))
//             {
//             }
//             column(Loan_Application1__Loan_Status_Caption; FieldCaption("Loan Status"))
//             {
//             }
//             column(Loan_Application1__Issued_Date_Caption; FieldCaption("Issued Date"))
//             {
//             }
//             column(Loan_Application1__Deduction_Code_Caption; FieldCaption("Deduction Code"))
//             {
//             }
//             column(Loan_Application1__Interest_Deduction_Code_Caption; FieldCaption("Interest Deduction Code"))
//             {
//             }
//             column(Loan_Application1__Interest_Rate_Caption; FieldCaption("Interest Rate"))
//             {
//             }
//             trigger OnAfterGetRecord();
//             begin
//                 "Loan Application1".Validate("Loan Application1"."Loan Product Type");
//                 //"Loan Application"."Issued Date":=20100112D;
//                 "Loan Status" := "loan status"::Application;
//                 "Loan Application1".Modify;
//                 if "Loan Status" = "loan status"::Issued then
//                     Error('Loan Already Issued');
//                 if "Issued Date" = 0D then
//                     Error('You must specify the issue date before issuing the loan');
//                 if "Approved Amount" = 0 then
//                     Error('You must specify the Approved amount before issuing the loan');
//                 if "Opening Loan" = false then begin
//                     /*schedule.RESET;
//                     schedule.SETRANGE("Loan No","Loan No");
//                     schedule.SETRANGE(schedule."Employee No","Employee No");
//                     IF NOT schedule.FIND('-') THEN
//                       ERROR('No schedule created yet');*/
//                     Emp.Get("Employee No");
//                     AssMatrix.Init;
//                     AssMatrix."Employee No" := "Employee No";
//                     AssMatrix.Type := AssMatrix.Type::Deduction;
//                     AssMatrix."Reference No" := "Loan No";
//                     if "Deduction Code" = '' then
//                         Error('Loan %1 must be associated with a deduction', "Loan Product Type")
//                     else
//                         AssMatrix.Code := "Deduction Code";
//                     AssMatrix."Payroll Period" := "Issued Date";
//                     AssMatrix.Description := Description;
//                     AssMatrix."Payroll Group" := Emp."Posting Group";
//                     AssMatrix."Global Dimension 1 code" := Emp."Global Dimension 1 Code";
//                     AssMatrix.Amount := Repayment;
//                     AssMatrix."Next Period Entry" := true;
//                     AssMatrix.Validate(AssMatrix.Amount);
//                     AssMatrix.Insert;
//                     "Loan Status" := "loan status"::Issued;
//                     Modify;
//                     Message('Loan Issued');
//                 end else begin
//                     Emp.Get("Employee No");
//                     AssMatrix.Init;
//                     AssMatrix."Employee No" := "Employee No";
//                     AssMatrix.Type := AssMatrix.Type::Deduction;
//                     AssMatrix.Code := "Deduction Code";
//                     AssMatrix."Payroll Period" := "Issued Date";
//                     AssMatrix."Reference No" := "Loan No";
//                     AssMatrix.Description := Description;
//                     AssMatrix."Payroll Group" := Emp."Posting Group";
//                     AssMatrix."Global Dimension 1 code" := Emp."Global Dimension 1 Code";
//                     AssMatrix.Amount := Repayment;
//                     AssMatrix.Validate(AssMatrix.Amount);
//                     AssMatrix."Next Period Entry" := true;
//                     AssMatrix.Insert;
//                     "Loan Status" := "loan status"::Issued;
//                     Modify;
//                     Message('Loan Issued');
//                 end;

//             end;

//         }
//     }
//     requestpage
//     {
//         SaveValues = false;
//         layout
//         {
//             area(Content)
//             {
//                 group(Options)
//                 {
//                     Caption = 'Options';
//                     field(ForNavOpenDesigner; ReportForNavOpenDesigner)
//                     {
//                         ApplicationArea = Basic;
//                         Caption = 'Design';
//                         Visible = ReportForNavAllowDesign;
//                     }
//                 }
//             }
//         }

//     }

//     trigger OnInitReport()
//     begin
//         //;
//         //ReportsForNavInit;

//     end;

//     trigger OnPostReport()
//     begin
//         //;
//         ////ReportForNav.Post;
//     end;

//     trigger OnPreReport()
//     begin
//         //;
//         //ReportsForNavPre;
//     end;

//     var
//         schedule: Record "Repayment Schedule1";
//         Emp: Record Employee;
//         AssMatrix: Record "Assignment Matrix-X1";
//         Loan_ApplicationCaptionLbl: label 'Loan Application';
//         CurrReport_PAGENOCaptionLbl: label 'Page';

//     // --> Reports ForNAV Autogenerated code - do not delete or modify
//     var
//         //[WithEvents]
//         //ReportForNav: DotNet ForNavReport51511084_v7_3_0_2559;
//         ReportForNavOpenDesigner: Boolean;

//         ReportForNavAllowDesign: Boolean;

//     /*local procedure ReportsForNavInit();
//     var
//         ApplicationSystemConstants: Codeunit "Application System Constants";
//         addInFileName: Text;
//         tempAddInFileName: Text;
//         path: DotNet System_IO_Path51511084;
//         ReportForNavObject: Variant;
//     begin
//         addInFileName := ApplicationPath() + 'Add-ins\ReportsForNAV_7_3_0_2559\ForNav.Reports.7.3.0.2559.dll';
//         if not File.Exists(addInFileName) then begin
//             tempAddInFileName := path.GetTempPath() + '\Microsoft Dynamics NAV\Add-Ins\' + ApplicationSystemConstants.PlatformFileVersion() + '\ForNav.Reports.7.3.0.2559.dll';
//             if not File.Exists(tempAddInFileName) then
//                 Error('Please install the ForNAV DLL version 7.3.0.2559 in your service tier Add-ins folder under the file name "%1"\\If you already have the ForNAV DLL on the server, you should move it to this folder and rename it to match this file name.', addInFileName);
//         end;
//         ReportForNavObject := //ReportForNav.GetLatest(CurrReport.OBJECTID, CurrReport.Language, SerialNumber, UserId, CompanyName);
//         ReportForNav := ReportForNavObject;
//         //ReportForNav.Init();
//     end;

//     //local procedure ReportsForNavPre();
//     // begin
//     ////ReportForNav.OpenDesigner := ReportForNavOpenDesigner;
//     //if not //ReportForNav.Pre() then CurrReport.Quit();
//     //end;*/

//     // Reports ForNAV Autogenerated code - do not delete or modify -->
// }
